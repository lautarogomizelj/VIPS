@model List<UsuarioViewModel>

    @{
    Layout = "_AdminLayout";
    string lang = User.FindFirst("Lang")?.Value ?? "es";
    }

    <div class="filtrosContenedor">

        <form method="get" asp-controller="AdminGeneral" asp-action="UserManagement" class="FILTER">

            <div class="contenedor-info">
                <label for="columna"><h4>@(lang == "es" ? "Columna:" : "Column:")</h4></label>
                <select id="columna" name="columna">
                    <option value="usuario" selected="@(ViewBag.Columna == "usuario" ? "selected" : null)">
                        @(lang == "es" ? "Usuario" : "User")
                    </option>
                    <option value="nombre" selected="@(ViewBag.Columna == "nombre" ? "selected" : null)">
                        @(lang == "es" ? "Rol" : "Role")
                    </option>
                    <option value="fechaCreacion" selected="@(ViewBag.Columna == "fechaCreacion" ? "selected" : null)">
                        @(lang == "es" ? "Fecha Alta" : "Creation Date")
                    </option>
                    <option value="fechaUltimoLogin" selected="@(ViewBag.Columna == "fechaUltimoLogin" ? "selected" : null)">
                        @(lang == "es" ? "Último Acceso" : "Last Login")
                    </option>
                    <option value="fechaUltimoIntentoFallido" selected="@(ViewBag.Columna == "fechaUltimoIntentoFallido" ? "selected" : null)">
                        @(lang == "es" ? "Último Acceso fallido" : "Last Failed Login")
                    </option>
                </select>

                <label for="orden"><h4>@(lang == "es" ? "Orden:" : "Order:")</h4></label>
                <select id="orden" name="orden">
                    <option value="asc" selected="@(ViewBag.Orden == "asc" ? "selected" : null)">
                        @(lang == "es" ? "Ascendente" : "Ascending")
                    </option>
                    <option value="desc" selected="@(ViewBag.Orden == "desc" ? "selected" : null)">
                        @(lang == "es" ? "Descendente" : "Descending")
                    </option>
                </select>
            </div>


            <div class="contenedor-info">
                <label for="usuario"><h4>@(lang == "es" ? "Usuario:" : "Username:")</h4></label>
                <input type="text" id="usuario" name="usuario" class="form-control" value="@ViewBag.Usuario" />
            </div>

            <div class="contenedor-info">
                <button class="btn-principal filtros" type="submit">@(lang == "es" ? "Aplicar filtros" : "Apply Filters")</button>
            </div>

        </form>

        <a asp-controller="AdminGeneral" asp-action="CreateUser" class="btn-principal filtros">
            @(lang == "es" ? "Agregar usuario" : "Add User")
        </a>

        <a asp-controller="AdminGeneral" asp-action="ExportarUsuariosPdf" asp-route-columna="@ViewBag.Columna" asp-route-orden="@ViewBag.Orden"  asp-route-usuario="@ViewBag.Usuario" class="btn-principal filtros">
            @(lang == "es" ? "Exportar a pdf" : "Export to PDF")
        </a>
    </div>

    <table>
        <thead>

            <tr>
                <th>@(lang == "es" ? "Usuario" : "User")</th>
                <th>@(lang == "es" ? "Rol" : "Role")</th>
                <th>@(lang == "es" ? "Fecha alta" : "Creation Date")</th>
                <th>@(lang == "es" ? "Fecha último acceso" : "Last Login")</th>
                <th>@(lang == "es" ? "Fecha ult. acceso fallido" : "Last Failed Login")</th>
                <th>@(lang == "es" ? "Acciones" : "Actions")</th>
            </tr>
        </thead>

        <tbody>


            @foreach (var usuario in Model)
    {
            <tr>
                <td>@usuario.Usuario</td>
                <td>@usuario.Rol</td>
                <td>@usuario.FechaAlta.ToString("dd/MM/yyyy")</td>
                <td>@(usuario.FechaUltimoAcceso.HasValue ? usuario.FechaUltimoAcceso.Value.ToString("dd/MM/yyyy HH:mm") : "-")</td>
                <td>@(usuario.FechaUltimoAccesoFallido.HasValue ? usuario.FechaUltimoAccesoFallido.Value.ToString("dd/MM/yyyy HH:mm") : "-")</td>
                <td class="svg-container flex">

                    <a asp-controller="AdminGeneral" asp-action="EditUser" asp-route-username="@usuario.Usuario">
                        ✏️
                    </a>

                    <a asp-controller="AdminGeneral" asp-action="DeleteUser" asp-route-username="@usuario.Usuario">
                        🗑️
                    </a>

                </td>
            </tr>
    }

        </tbody>

    </table>

